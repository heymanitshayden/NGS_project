#SRA accession: ERP000109# Refence genome accession: NC_002516 # Using BRAT I used the command: ./trim -s p_aeruginosa_reads.fastq -P pa_out# Using BOWTIE, I used the Pesudomonas aeruginosa PAO1 genome (NC_002516.2) to build my reference genome:  ./bowtie-build p_aeruginosa_ref.fasta p_aeruginosa_build ./bowtie p_aeruginosa_build pa_out_pair1.fastq pair.pa.sam -l 24 -X 600 --sam -q --fr -t -n 3 --al pair.pa.align --un pair.pa.unmapped 2>&1 | tee pa.pair.log# reads with at least one reported alignment: 10675498 (96.49%)./samtools view -bS -o pair.pa.bam pair.pa.sam./samtools sort pair.pa.bam pair.pa.sorted.bam./samtools index pair.pa.sorted.bam/Users/haydenthomas/documents/coronavirus #If needed# Using Samtools I converted the sorted BAM file to fastq, from fastq to fasta to find the N50 and N90 values using the perl script from lecture: ./samtools bam2fq pair.pa.sorted.bam > my.fastqpaste - - - - < my.fastq | cut -f 1,2 | sed 's/^@/>/' | tr "\t" "\n" > my.faperl N50.pl my.faN50 = 36 N90 = 36./samtools mpileup pair.pa.sorted.bam | awk -v X="${MIN_COVERAGE_DEPTH}" '$4>=X' | wc -l#Reference genome has 6,264,404 bases = 99.98%./samtools depth pair.pa.sorted.bam | awk '{sum+=$3} END {print "Average = "sum/NR}'Average = 61.3587#Here I piped the results of the samtools mpileup function to VarScan to compute the number of SNPs and Indels identified from mapping the sample to the reference genome../samtools mpileup -f p_aeruginosa_ref.fasta -B -q 30 pair.pa.sorted.bam | java -jar VarScan.v2.3.9.jar mpileup2snp --mpileup1 mpileup2indel --mpileup1 --min-coverage 50 --p-value 0.01 --min-var-freq 0.04286 variant positions reported, 286 as SNPs and 0 as indels. # using Velevet velveth velvet.out 21 my.favelvetg velvet.out99,590 nodes  total bps = 6413053perl N50.pl ./velvet.out/contigs.faN50: 292N90: 93#Align reads with de novo assembly as reference genome: ./bowtie-build contigs.fa de.novo_ref./bowtie de.novo_ref pa_out_pair1.fastq pair.denovo.sam -l 24 -X 600 --sam -q --fr -t -n 3 --al pair.denovo.align --un pair.denovo.unmapped 2>&1 | tee pa.denovo.log#Reads with at least one reported alignment : 9763305 (88.25%)# Analyses using Samtools ./samtools view -bS -o pair.denovo.bam pair.denovo.sam./samtools sort pair.denovo.bam pair.denovo.sorted#% Coverage ./samtools mpileup pair.denovo.sorted.bam | awk -v X="${MIN_COVERAGE_DEPTH}" '$4>=X' | wc -l[mpileup] 1 samples in 1 input fileOutput: 6,719,275 bp ; the de novo assembly = 6,413,053 = 104.77498% #Average Seq. Depth ./samtools depth pair.denovo.sorted.bam | awk '{sum+=$3} END {print  "Average = "sum/NR}'Average = 52.3084 #Perl code for N50 and N90 calculations: #/usr/bin/perl -wuse strict;my ($len,$total)=(0,0);my @x;while(<>){	if(/^[\>\@]/){		if($len>0){			$total+=$len;			push @x,$len;		}		$len=0;	}	else{		s/\s//g;		$len+=length($_);	}}if ($len>0){	$total+=$len;	push @x,$len;}@x=sort{$b<=>$a} @x; my ($count,$half)=(0,0);for (my $j=0;$j<@x;$j++){	$count+=$x[$j];	if (($count>=$total/2)&&($half==0)){		print "N50: $x[$j]\n";		$half=$x[$j]	}elsif ($count>=$total*0.9){		print "N90: $x[$j]\n";		exit;	}}Hayden Thomashthoma25AS.410.713.81	Final Project Code